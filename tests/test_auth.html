<!DOCTYPE html>
<html>
  <head>
    <title>MetaMask Sign Data Example</title>
    <script src="https://cdn.jsdelivr.net/npm/web3@1.5.2/dist/web3.min.js"></script>
  </head>
  <body>
    <h1>MetaMask Sign Data Example</h1>
    <button onclick="signData()">Sign Data</button>
    <p id="result"></p>
    <script>
      // Check if MetaMask is installed
      async function checkMetaMask(){
        if (typeof window.ethereum !== 'undefined') {
          console.log('MetaMask is installed!')
          const accounts = await ethereum.request({ method: 'eth_requestAccounts' });
          const walletAddress = accounts[0];
          return walletAddress;
        } else {
          console.log('MetaMask is not installed!');
          return null;
        }
      }

      // Sign the data
      async function signData() {
        const walletAddress = await checkMetaMask();
        if (walletAddress){
          const currentDate = new Date().toISOString().slice(0, 10);
          const message = walletAddress + '-' + currentDate;
          ethereum.request({ method: 'personal_sign', params: [message, walletAddress] })
          .then(signature => {
            console.log('Signature: ', signature)
            const result = document.getElementById('result')
            result.innerHTML = 'Message: ' + message + '<br>Signature: ' + signature
          })
        }
      }
    </script>
  </body>
</html>